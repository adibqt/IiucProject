# Architecture & System Design

## ğŸ—ï¸ Overall System Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        CLIENT LAYER (Frontend)                       â”‚
â”‚  React App                                                            â”‚
â”‚  â”œâ”€ Login Page          â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚  â”œâ”€ Register Page       â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                       â”‚
â”‚  â”œâ”€ Dashboard                               â”‚                       â”‚
â”‚  â”œâ”€ Profile Page        â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                       â”‚
â”‚  â”œâ”€ Skills Page         â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                       â”‚
â”‚  â””â”€ CV Page             â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                â”‚
                    HTTP/REST API Calls         â”‚ JWT in Headers
                                                â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     FASTAPI APPLICATION LAYER                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                        Middleware                             â”‚   â”‚
â”‚  â”‚  â”œâ”€ CORS Handler                                            â”‚   â”‚
â”‚  â”‚  â”œâ”€ JWT Verification (get_current_user)                    â”‚   â”‚
â”‚  â”‚  â””â”€ Error Handler                                          â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    API Routes (api_users.py)                â”‚   â”‚
â”‚  â”‚                                                              â”‚   â”‚
â”‚  â”‚  Public Routes:                Protected Routes:           â”‚   â”‚
â”‚  â”‚  â”œâ”€ POST /register      â”€â”€â”€â”€â”€â”¤  â”œâ”€ GET /me               â”‚   â”‚
â”‚  â”‚  â”œâ”€ POST /login         â”€â”€â”€â”€â”€â”¤  â”œâ”€ PUT /me               â”‚   â”‚
â”‚  â”‚  â””â”€ GET /{id}           â”€â”€â”€â”€â”€â”¤  â”œâ”€ POST /me/skills       â”‚   â”‚
â”‚  â”‚                         â”€â”€â”€â”€â”€â”¤  â”œâ”€ DELETE /me/skills     â”‚   â”‚
â”‚  â”‚                         â”€â”€â”€â”€â”€â”¤  â”œâ”€ GET /me/skills        â”‚   â”‚
â”‚  â”‚                         â”€â”€â”€â”€â”€â”¤  â”œâ”€ PUT /me/cv            â”‚   â”‚
â”‚  â”‚                         â”€â”€â”€â”€â”€â”¤  â””â”€ POST /logout          â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                Service Layer (user_service.py)               â”‚   â”‚
â”‚  â”‚                                                              â”‚   â”‚
â”‚  â”‚  â”œâ”€ register_user()          (Validation + DB insert)      â”‚   â”‚
â”‚  â”‚  â”œâ”€ authenticate_user()       (Login logic)                â”‚   â”‚
â”‚  â”‚  â”œâ”€ get_user_profile()        (Fetch user)                â”‚   â”‚
â”‚  â”‚  â”œâ”€ update_user_profile()     (Update fields)             â”‚   â”‚
â”‚  â”‚  â”œâ”€ add_skill()               (Skill management)          â”‚   â”‚
â”‚  â”‚  â”œâ”€ remove_skill()            (Skill management)          â”‚   â”‚
â”‚  â”‚  â”œâ”€ get_user_skills()         (List skills)              â”‚   â”‚
â”‚  â”‚  â””â”€ set_cv_text()             (CV storage)               â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚           Data Validation & Schemas (schemas.py)             â”‚   â”‚
â”‚  â”‚                                                              â”‚   â”‚
â”‚  â”‚  â”œâ”€ UserRegister      (Input validation)                   â”‚   â”‚
â”‚  â”‚  â”œâ”€ UserLogin         (Input validation)                   â”‚   â”‚
â”‚  â”‚  â”œâ”€ UserProfile       (Output schema)                      â”‚   â”‚
â”‚  â”‚  â”œâ”€ UserUpdate        (Update validation)                  â”‚   â”‚
â”‚  â”‚  â””â”€ UserLoginResponse (Token response)                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚        Security Layer (auth.py)                              â”‚   â”‚
â”‚  â”‚                                                              â”‚   â”‚
â”‚  â”‚  â”œâ”€ get_password_hash()    (Bcrypt hashing)               â”‚   â”‚
â”‚  â”‚  â”œâ”€ verify_password()       (Bcrypt verification)          â”‚   â”‚
â”‚  â”‚  â”œâ”€ create_access_token()   (JWT generation)              â”‚   â”‚
â”‚  â”‚  â””â”€ decode_access_token()   (JWT verification)            â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â”‚ SQLAlchemy ORM
                              â”‚ SQL Queries
                              â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   DATA ACCESS LAYER (database.py)                    â”‚
â”‚                                                                       â”‚
â”‚  â”œâ”€ Database Session Management (get_db dependency)                 â”‚
â”‚  â”œâ”€ Connection Pooling                                              â”‚
â”‚  â””â”€ SQLAlchemy Engine                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â”‚ PostgreSQL Protocol
                              â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    DATABASE LAYER (PostgreSQL)                       â”‚
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    USERS TABLE                               â”‚   â”‚
â”‚  â”‚                                                              â”‚   â”‚
â”‚  â”‚  Column                Type              Constraints        â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚   â”‚
â”‚  â”‚  id                    SERIAL            PRIMARY KEY        â”‚   â”‚
â”‚  â”‚  email                 VARCHAR(255)      UNIQUE, NOT NULL   â”‚   â”‚
â”‚  â”‚  username              VARCHAR(100)      UNIQUE, NOT NULL   â”‚   â”‚
â”‚  â”‚  hashed_password       VARCHAR(255)      NOT NULL           â”‚   â”‚
â”‚  â”‚  full_name             VARCHAR(255)      NULLABLE           â”‚   â”‚
â”‚  â”‚  role                  ENUM              DEFAULT 'student'  â”‚   â”‚
â”‚  â”‚  education_level       VARCHAR(100)      NULLABLE           â”‚   â”‚
â”‚  â”‚  experience_level      VARCHAR(50)       DEFAULT 'fresher'  â”‚   â”‚
â”‚  â”‚  preferred_career_track VARCHAR(255)     NULLABLE           â”‚   â”‚
â”‚  â”‚  skills                TEXT (JSON)       NULLABLE           â”‚   â”‚
â”‚  â”‚  experiences           TEXT (JSON)       NULLABLE           â”‚   â”‚
â”‚  â”‚  cv_text               TEXT              NULLABLE           â”‚   â”‚
â”‚  â”‚  is_active             BOOLEAN           DEFAULT TRUE       â”‚   â”‚
â”‚  â”‚  is_verified           BOOLEAN           DEFAULT FALSE      â”‚   â”‚
â”‚  â”‚  created_at            TIMESTAMP         DEFAULT NOW()      â”‚   â”‚
â”‚  â”‚  updated_at            TIMESTAMP         DEFAULT NOW()      â”‚   â”‚
â”‚  â”‚  last_login            TIMESTAMP         NULLABLE           â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                       â”‚
â”‚  Indexes:                                                            â”‚
â”‚  â”œâ”€ idx_users_email         (For login queries)                     â”‚
â”‚  â”œâ”€ idx_users_username      (For username lookup)                   â”‚
â”‚  â””â”€ idx_users_role          (For role-based queries)                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”„ Request/Response Flow Diagram

### Registration Flow

```
User Submits Registration Form
              â”‚
              â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Pydantic Schema  â”‚
    â”‚   Validation     â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚ Valid?
             â”œâ”€â”€â”€â”€â”€Noâ”€â”€â”€â”€â”€â”€â–º 422 Unprocessable Entity
             â”‚
             Yes
             â”‚
             â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Check Email     â”‚
    â”‚  Uniqueness      â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚ Unique?
             â”œâ”€â”€â”€â”€â”€Noâ”€â”€â”€â”€â”€â”€â–º 400 Bad Request
             â”‚
             Yes
             â”‚
             â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Hash Password    â”‚
    â”‚ (Bcrypt)         â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Create User      â”‚
    â”‚ in Database      â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Generate JWT     â”‚
    â”‚ Token            â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
      Return 201 Created
      â”œâ”€ access_token
      â”œâ”€ token_type
      â””â”€ user profile
```

### Login Flow

```
User Submits Email/Password
              â”‚
              â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Validate Format  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Query Database   â”‚
    â”‚ for User         â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚ Found?
             â”œâ”€â”€â”€â”€â”€Noâ”€â”€â”€â”€â”€â”€â–º 401 Unauthorized
             â”‚
             Yes
             â”‚
             â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Verify Password  â”‚
    â”‚ (Bcrypt)         â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚ Match?
             â”œâ”€â”€â”€â”€â”€Noâ”€â”€â”€â”€â”€â”€â–º 401 Unauthorized
             â”‚
             Yes
             â”‚
             â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Check is_active  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚ Active?
             â”œâ”€â”€â”€â”€â”€Noâ”€â”€â”€â”€â”€â”€â–º 403 Forbidden
             â”‚
             Yes
             â”‚
             â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Update last_loginâ”‚
    â”‚ Timestamp        â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Generate JWT     â”‚
    â”‚ Token            â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
      Return 200 OK
      â”œâ”€ access_token
      â”œâ”€ token_type
      â””â”€ user profile
```

### Protected Route Access Flow

```
Client Request with Token
              â”‚
              â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Extract Token    â”‚
    â”‚ from Header      â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚ Found?
             â”œâ”€â”€â”€â”€â”€Noâ”€â”€â”€â”€â”€â”€â–º 401 Missing Token
             â”‚
             Yes
             â”‚
             â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Verify JWT       â”‚
    â”‚ Signature        â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚ Valid?
             â”œâ”€â”€â”€â”€â”€Noâ”€â”€â”€â”€â”€â”€â–º 401 Invalid Token
             â”‚
             Yes
             â”‚
             â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Check Token      â”‚
    â”‚ Expiration       â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚ Valid?
             â”œâ”€â”€â”€â”€â”€Noâ”€â”€â”€â”€â”€â”€â–º 401 Token Expired
             â”‚
             Yes
             â”‚
             â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Decode Token     â”‚
    â”‚ Extract Claims   â”‚
    â”‚ (email, role)    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Query Database   â”‚
    â”‚ for User         â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚ Found?
             â”œâ”€â”€â”€â”€â”€Noâ”€â”€â”€â”€â”€â”€â–º 404 User Not Found
             â”‚
             Yes
             â”‚
             â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Attach User to   â”‚
    â”‚ Request Context  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Execute Route    â”‚
    â”‚ Handler          â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
      Return 200 OK
      + Response Data
```

## ğŸ“Š Data Model Relationships

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           User Model                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                      â”‚
â”‚ Core Fields:                         â”‚
â”‚ â”œâ”€ id (PK)                          â”‚
â”‚ â”œâ”€ email (UNIQUE)                   â”‚
â”‚ â”œâ”€ username (UNIQUE)                â”‚
â”‚ â”œâ”€ hashed_password                  â”‚
â”‚ â”œâ”€ full_name                        â”‚
â”‚ â””â”€ role (ADMIN|INSTRUCTOR|STUDENT)  â”‚
â”‚                                      â”‚
â”‚ Profile Fields:                      â”‚
â”‚ â”œâ”€ bio                              â”‚
â”‚ â”œâ”€ avatar_url                       â”‚
â”‚ â””â”€ phone_number                     â”‚
â”‚                                      â”‚
â”‚ Career Fields (NEW):                 â”‚
â”‚ â”œâ”€ education_level                  â”‚
â”‚ â”œâ”€ experience_level                 â”‚
â”‚ â”œâ”€ preferred_career_track           â”‚
â”‚ â”œâ”€ skills (JSON array)              â”‚
â”‚ â”œâ”€ experiences (JSON array)         â”‚
â”‚ â””â”€ cv_text (For AI parsing)         â”‚
â”‚                                      â”‚
â”‚ AI-Ready Fields:                     â”‚
â”‚ â”œâ”€ learning_style                   â”‚
â”‚ â”œâ”€ skill_level                      â”‚
â”‚ â”œâ”€ interests                        â”‚
â”‚ â””â”€ career_goals                     â”‚
â”‚                                      â”‚
â”‚ Metadata:                            â”‚
â”‚ â”œâ”€ is_active                        â”‚
â”‚ â”œâ”€ is_verified                      â”‚
â”‚ â”œâ”€ created_at                       â”‚
â”‚ â”œâ”€ updated_at                       â”‚
â”‚ â””â”€ last_login                       â”‚
â”‚                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ” JWT Token Structure

```
Header (Algorithm & Type):
{
  "alg": "HS256",
  "typ": "JWT"
}

Payload (Claims):
{
  "sub": "john@example.com",      // Subject (user identifier)
  "role": "student",               // User role
  "exp": 1731498000,              // Expiration time (Unix timestamp)
  "iat": 1731411600              // Issued at time
}

Signature:
HMACSHA256(
  base64UrlEncode(header) + "." +
  base64UrlEncode(payload),
  secret_key
)

Complete Token Format:
eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.
eyJzdWIiOiJqb2huQGV4YW1wbGUuY29tIiwicm9sZSI6InN0dWRlbnQiLCJleHAiOjE3MzE0OTgwMDB9.
[signature_here]
```

## ğŸ›¡ï¸ Security Flow Diagram

```
User Password
      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Bcrypt Hashing         â”‚
â”‚   â”œâ”€ Generate Salt       â”‚
â”‚   â”œâ”€ Hash Password       â”‚
â”‚   â”‚  (with salt)         â”‚
â”‚   â””â”€ Create Hash         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
   Database Storage
   â”œâ”€ Never store plain text
   â”œâ”€ Hash is irreversible
   â””â”€ Unique per password
           â”‚
           â–¼
   Login Attempt
   â”œâ”€ User enters password
   â”œâ”€ Hash it with bcrypt
   â”œâ”€ Compare hashes
   â”‚  (constant-time)
   â””â”€ Return match result
           â”‚
           â–¼
   If Password Valid
   â”œâ”€ Create JWT token
   â”œâ”€ Sign with SECRET_KEY
   â”œâ”€ Set expiration (24h)
   â””â”€ Return to user
           â”‚
           â–¼
   Future Requests
   â”œâ”€ Send token in header
   â”œâ”€ Server verifies signature
   â”œâ”€ Check expiration
   â”œâ”€ Extract user info
   â””â”€ Allow request
```

## ğŸ“ˆ API Call Sequence Diagram

```
Frontend                    Backend                 Database
   â”‚                          â”‚                        â”‚
   â”‚  POST /register          â”‚                        â”‚
   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                        â”‚
   â”‚                          â”‚  Validate input        â”‚
   â”‚                          â”œâ”€ Check schema         â”‚
   â”‚                          â”‚  Check email unique   â”‚
   â”‚                          â”‚                        â”‚
   â”‚                          â”‚  Hash password         â”‚
   â”‚                          â”‚  INSERT user          â”‚
   â”‚                          â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
   â”‚                          â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
   â”‚                          â”‚  User created          â”‚
   â”‚                          â”‚                        â”‚
   â”‚                          â”‚  Generate JWT          â”‚
   â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                        â”‚
   â”‚  201 + token + user      â”‚                        â”‚
   â”‚                          â”‚                        â”‚
   â”‚  [Store token]           â”‚                        â”‚
   â”‚                          â”‚                        â”‚
   â”‚  GET /me                 â”‚                        â”‚
   â”‚  Header: Bearer token    â”‚                        â”‚
   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                        â”‚
   â”‚                          â”‚  Verify token         â”‚
   â”‚                          â”‚  Decode token         â”‚
   â”‚                          â”‚  Extract email        â”‚
   â”‚                          â”‚                        â”‚
   â”‚                          â”‚  SELECT user          â”‚
   â”‚                          â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
   â”‚                          â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
   â”‚                          â”‚  User record           â”‚
   â”‚                          â”‚                        â”‚
   â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                        â”‚
   â”‚  200 + user profile      â”‚                        â”‚
```

## ğŸ’¾ Database Connection Flow

```
Application Startup
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Load Configuration      â”‚
â”‚  â”œâ”€ DATABASE_URL         â”‚
â”‚  â”œâ”€ SECRET_KEY           â”‚
â”‚  â””â”€ Other settings       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Create SQLAlchemy       â”‚
â”‚  Engine                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Create Connection       â”‚
â”‚  Pool                    â”‚
â”œâ”€ Min connections: 5     â”‚
â””â”€ Max connections: 20    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Create Database         â”‚
â”‚  Tables                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
Application Ready
       â”‚
       â–¼
Request Arrives
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  get_db() Dependency     â”‚
â”‚  â”œâ”€ Get session from poolâ”‚
â”‚  â””â”€ Yield to route       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
Route Handler
       â”‚
       â–¼
Database Operations
       â”‚
       â–¼
Return Response
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Session Cleanup         â”‚
â”‚  â””â”€ Close connection     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”„ Middleware Processing Order

```
HTTP Request
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. CORS Middleware â”‚
â”‚ Check origin       â”‚
â”‚ Add headers        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ Pass
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. Route Matching  â”‚
â”‚ Find handler       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ Found
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. Dependency Injection    â”‚
â”‚ (if route requires it)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”œâ”€â–º get_db()
         â”‚   Get database session
         â”‚
         â””â”€â–º get_current_user()
             â”œâ”€ Extract token
             â”œâ”€ Verify signature
             â”œâ”€ Decode claims
             â””â”€ Fetch user
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4. Route Handler   â”‚
â”‚ Execute logic      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 5. Response Format â”‚
â”‚ Serialize JSON     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 6. HTTP Response   â”‚
â”‚ Send to client     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“š Class Hierarchy

```
BaseModel (Pydantic)
â”œâ”€â”€ UserBase
â”‚   â””â”€â”€ UserResponse
â”‚
â”œâ”€â”€ UserRegister
â”œâ”€â”€ UserLogin
â”œâ”€â”€ UserProfile
â”œâ”€â”€ UserUpdate
â””â”€â”€ UserLoginResponse


Base (SQLAlchemy)
â””â”€â”€ User
    â”œâ”€â”€ Relationships
    â”‚   â”œâ”€â”€ skills (M2M)
    â”‚   â”œâ”€â”€ courses_created
    â”‚   â”œâ”€â”€ enrolled_courses (M2M)
    â”‚   â”œâ”€â”€ progress_records
    â”‚   â””â”€â”€ ai_recommendations
    â”‚
    â””â”€â”€ Enums
        â”œâ”€â”€ UserRole
        â””â”€â”€ ExperienceLevel


Enum
â”œâ”€â”€ UserRole (admin, instructor, student)
â”œâ”€â”€ ExperienceLevel (fresher, junior, mid, senior)
â”œâ”€â”€ SkillLevel
â””â”€â”€ CourseStatus
```

---

This comprehensive architecture documentation provides complete understanding of the system design, data flow, security mechanisms, and integration points.
